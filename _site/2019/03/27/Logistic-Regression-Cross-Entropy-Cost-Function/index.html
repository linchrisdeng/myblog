<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="What did I do && What will I do">
    <meta name="keywords"  content="">
    <meta name="theme-color" content="">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Logistic Regression -- Cross Entropy Cost Function - Lin Blog | Blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="Introduction

">
    
    <meta property="article:published_time" content="2019-03-27T07:00:00Z">
    
    
    <meta property="article:author" content="LIN">
    
    
    <meta property="article:tag" content="Machine Learning">
    
    <meta property="article:tag" content="Optimization">
    
    <meta property="article:tag" content="Logistic Regression">
    
    <meta property="article:tag" content="Python">
    
    <meta property="article:tag" content="Gradient Descent">
    
    <meta property="article:tag" content="Newton's Method">
    
    
    <meta property="og:image" content="http://localhost:4000/img/sidebar_img.jpg">
    <meta property="og:url" content="http://localhost:4000/2019/03/27/Logistic-Regression-Cross-Entropy-Cost-Function/">
    <meta property="og:site_name" content="Lin Blog | Blog">
    
    <title>Logistic Regression -- Cross Entropy Cost Function - Lin Blog | Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2019/03/27/Logistic-Regression-Cross-Entropy-Cost-Function/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- p5.js insert -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/p5.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Lin Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="/archive/">Archive</a>
                    </li>
                    
                    
                    
                    
                    
                    <li>
                        <a href="/portfolio/">Portfolio</a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/in-post/post-MLOptimization-2.jpg" width="0" height="0"> -->
<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/in-post/post-MLOptimization-2.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=Machine+Learning" title="Machine Learning">Machine Learning</a>
                        
                        <a class="tag" href="/archive/?tag=Optimization" title="Optimization">Optimization</a>
                        
                        <a class="tag" href="/archive/?tag=Logistic+Regression" title="Logistic Regression">Logistic Regression</a>
                        
                        <a class="tag" href="/archive/?tag=Python" title="Python">Python</a>
                        
                        <a class="tag" href="/archive/?tag=Gradient+Descent" title="Gradient Descent">Gradient Descent</a>
                        
                        <a class="tag" href="/archive/?tag=Newton%27s+Method" title="Newton's Method">Newton's Method</a>
                        
                    </div>
                    <h1>Logistic Regression -- Cross Entropy Cost Function</h1>
                    
                    <h2 class="subheading">{0, 1} class problem</h2>
                    <span class="meta">Posted by LIN on March 27, 2019</span>
                </div>
            </div>
        </div>
    </div>
</header>





<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">
                <!-- Multi-Lingual -->
                
                <h2 id="introduction">Introduction</h2>

<p>In this blog I will describe a popular and one of my favorite model <strong>Logistic Regression.</strong> And this is also the first classification method appeared in my blog, but we still call this is a <em>regression</em> rather than a <em>classification</em> method as it is a non-linear curve cross two-class.</p>

<p>Here is a small sample:</p>

<html lang="en">
  
  <head>
    
      <meta charset="utf-8" />
      <title>Bokeh Plot</title>
      
      
        
          
        <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.css" type="text/css" />
        
        
          
        <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.js"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  </head>
  
  
  <body>
    
      
        
          
          
            
              <div class="bk-root" id="7e478c40-5f55-431e-99cc-28b54b9033f0" data-root-id="7117"></div>
            
          
        
      
      
        <script type="application/json" id="7373">
          {"9c47f114-5ae8-4a27-9642-84193fd9ab63":{"roots":{"references":[{"attributes":{"source":{"id":"7109","type":"ColumnDataSource"}},"id":"7113","type":"CDSView"},{"attributes":{"formatter":{"id":"7125","type":"BasicTickFormatter"},"ticker":{"id":"7094","type":"BasicTicker"}},"id":"7093","type":"LinearAxis"},{"attributes":{"below":[{"id":"7088","type":"LinearAxis"}],"center":[{"id":"7092","type":"Grid"},{"id":"7097","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"7093","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"7107","type":"GlyphRenderer"},{"id":"7112","type":"GlyphRenderer"}],"title":{"id":"7078","type":"Title"},"toolbar":{"id":"7098","type":"Toolbar"},"x_range":{"id":"7080","type":"DataRange1d"},"x_scale":{"id":"7084","type":"LinearScale"},"y_range":{"id":"7082","type":"DataRange1d"},"y_scale":{"id":"7086","type":"LinearScale"}},"id":"7077","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"7064","type":"LinearScale"},{"attributes":{},"id":"7094","type":"BasicTicker"},{"attributes":{"children":[{"id":"7057","subtype":"Figure","type":"Plot"},{"id":"7077","subtype":"Figure","type":"Plot"}]},"id":"7117","type":"Row"},{"attributes":{"dimension":1,"ticker":{"id":"7094","type":"BasicTicker"}},"id":"7097","type":"Grid"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"7076","type":"Toolbar"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"7098","type":"Toolbar"},{"attributes":{"text":""},"id":"7118","type":"Title"},{"attributes":{"text":"Linear Regression"},"id":"7078","type":"Title"},{"attributes":{"callback":null},"id":"7080","type":"DataRange1d"},{"attributes":{},"id":"7121","type":"BasicTickFormatter"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7100","type":"Circle"},{"attributes":{"formatter":{"id":"7123","type":"BasicTickFormatter"},"ticker":{"id":"7067","type":"BasicTicker"}},"id":"7066","type":"LinearAxis"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7101","type":"Circle"},{"attributes":{},"id":"7125","type":"BasicTickFormatter"},{"attributes":{"formatter":{"id":"7121","type":"BasicTickFormatter"},"ticker":{"id":"7072","type":"BasicTicker"}},"id":"7071","type":"LinearAxis"},{"attributes":{"data_source":{"id":"7099","type":"ColumnDataSource"},"glyph":{"id":"7100","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7101","type":"Circle"},"selection_glyph":null,"view":{"id":"7103","type":"CDSView"}},"id":"7102","type":"GlyphRenderer"},{"attributes":{},"id":"7062","type":"LinearScale"},{"attributes":{},"id":"7127","type":"BasicTickFormatter"},{"attributes":{"source":{"id":"7099","type":"ColumnDataSource"}},"id":"7103","type":"CDSView"},{"attributes":{"ticker":{"id":"7067","type":"BasicTicker"}},"id":"7070","type":"Grid"},{"attributes":{},"id":"7129","type":"UnionRenderers"},{"attributes":{},"id":"7072","type":"BasicTicker"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7130","type":"Selection"},"selection_policy":{"id":"7129","type":"UnionRenderers"}},"id":"7099","type":"ColumnDataSource"},{"attributes":{},"id":"7130","type":"Selection"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"xAdpxUufuD9qm6YSdXzEP5bjlxTo98Q/8VjzIBV00D/b+tT3k1TVP3gwIqrT3dY/PvmJabPx2j+oYjHyTSTvP4aj8ugel/A//ETZiBlF8T9z5r8oFPPxPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7134","type":"Selection"},"selection_policy":{"id":"7133","type":"UnionRenderers"}},"id":"7109","type":"ColumnDataSource"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7105","type":"Circle"},{"attributes":{"callback":null},"id":"7082","type":"DataRange1d"},{"attributes":{},"id":"7131","type":"UnionRenderers"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7106","type":"Circle"},{"attributes":{},"id":"7132","type":"Selection"},{"attributes":{"data_source":{"id":"7104","type":"ColumnDataSource"},"glyph":{"id":"7105","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7106","type":"Circle"},"selection_glyph":null,"view":{"id":"7108","type":"CDSView"}},"id":"7107","type":"GlyphRenderer"},{"attributes":{"dimension":1,"ticker":{"id":"7072","type":"BasicTicker"}},"id":"7075","type":"Grid"},{"attributes":{},"id":"7133","type":"UnionRenderers"},{"attributes":{},"id":"7134","type":"Selection"},{"attributes":{"below":[{"id":"7066","type":"LinearAxis"}],"center":[{"id":"7070","type":"Grid"},{"id":"7075","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"7071","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"7102","type":"GlyphRenderer"}],"title":{"id":"7118","type":"Title"},"toolbar":{"id":"7076","type":"Toolbar"},"x_range":{"id":"7058","type":"DataRange1d"},"x_scale":{"id":"7062","type":"LinearScale"},"y_range":{"id":"7060","type":"DataRange1d"},"y_scale":{"id":"7064","type":"LinearScale"}},"id":"7057","subtype":"Figure","type":"Plot"},{"attributes":{"source":{"id":"7104","type":"ColumnDataSource"}},"id":"7108","type":"CDSView"},{"attributes":{"formatter":{"id":"7127","type":"BasicTickFormatter"},"ticker":{"id":"7089","type":"BasicTicker"}},"id":"7088","type":"LinearAxis"},{"attributes":{},"id":"7089","type":"BasicTicker"},{"attributes":{},"id":"7084","type":"LinearScale"},{"attributes":{},"id":"7123","type":"BasicTickFormatter"},{"attributes":{"line_color":{"value":"green"},"line_dash":[6],"line_width":{"value":3},"location":0.5},"id":"7114","type":"Span"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"7110","type":"Line"},{"attributes":{"callback":null},"id":"7058","type":"DataRange1d"},{"attributes":{"callback":null},"id":"7060","type":"DataRange1d"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"7111","type":"Line"},{"attributes":{"ticker":{"id":"7089","type":"BasicTicker"}},"id":"7092","type":"Grid"},{"attributes":{},"id":"7086","type":"LinearScale"},{"attributes":{"data_source":{"id":"7109","type":"ColumnDataSource"},"glyph":{"id":"7110","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7111","type":"Line"},"selection_glyph":null,"view":{"id":"7113","type":"CDSView"}},"id":"7112","type":"GlyphRenderer"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7132","type":"Selection"},"selection_policy":{"id":"7131","type":"UnionRenderers"}},"id":"7104","type":"ColumnDataSource"},{"attributes":{},"id":"7067","type":"BasicTicker"}],"root_ids":["7117"]},"title":"Bokeh Application","version":"1.1.0"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('7373').textContent;
                  var render_items = [{"docid":"9c47f114-5ae8-4a27-9642-84193fd9ab63","roots":{"7117":"7e478c40-5f55-431e-99cc-28b54b9033f0"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        embed_document(root);
                        clearInterval(timer);
                      }
                      attempts++;
                      if (attempts > 100) {
                        console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        clearInterval(timer);
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  </body>
  
</html>

<p>where we fit a linear regression by using</p>

<script type="math/tex; mode=display">w=\left(X^{T} X\right)^{-1} X^{T} Y</script>

<p>However, we may find that linear regression cannot be used to classification problem, since we need a more descriptive method.</p>

<h2 id="logistic-sigmoid-function">Logistic Sigmoid Function</h2>

<script type="math/tex; mode=display">\sigma(w^Tx)=\frac{1}{1+e^{-(w^Tx)}}</script>

<script type="math/tex; mode=display">\sigma(z)=\frac{1}{1+e^{-z}}</script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">y_new</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> 
<span class="c1">## sklearn here aims to save time, detailed parameters optimization will be intereprted later
</span>
<span class="n">output_file</span><span class="p">(</span><span class="s">"logit_01.html"</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">plot_height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">plot_width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
            <span class="n">tools</span> <span class="o">=</span> <span class="s">""</span><span class="p">)</span>
<span class="n">p3</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
<span class="n">p3</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">p3</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
<span class="n">p3</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"red"</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">row</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<html lang="en">
  
  <head>
    
      <meta charset="utf-8" />
      <title>Bokeh Plot</title>
      
      
        
          
        <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.css" type="text/css" />
        
        
          
        <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.js"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  </head>
  
  
  <body>
    
      
        
          
          
            
              <div class="bk-root" id="acfcce5e-4a1d-4eeb-8e08-56dac9d7edb6" data-root-id="7407"></div>
            
          
        
      
      
        <script type="application/json" id="7713">
          {"b979f4b0-8b67-48e0-8416-73c439051e3a":{"roots":{"references":[{"attributes":{"children":[{"id":"7077","subtype":"Figure","type":"Plot"},{"id":"7374","subtype":"Figure","type":"Plot"}]},"id":"7407","type":"Row"},{"attributes":{"source":{"id":"7109","type":"ColumnDataSource"}},"id":"7113","type":"CDSView"},{"attributes":{"formatter":{"id":"7125","type":"BasicTickFormatter"},"ticker":{"id":"7094","type":"BasicTicker"}},"id":"7093","type":"LinearAxis"},{"attributes":{"data_source":{"id":"7396","type":"ColumnDataSource"},"glyph":{"id":"7397","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7398","type":"Circle"},"selection_glyph":null,"view":{"id":"7400","type":"CDSView"}},"id":"7399","type":"GlyphRenderer"},{"attributes":{"below":[{"id":"7088","type":"LinearAxis"}],"center":[{"id":"7092","type":"Grid"},{"id":"7097","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"7093","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"7107","type":"GlyphRenderer"},{"id":"7112","type":"GlyphRenderer"}],"title":{"id":"7078","type":"Title"},"toolbar":{"id":"7098","type":"Toolbar"},"x_range":{"id":"7080","type":"DataRange1d"},"x_scale":{"id":"7084","type":"LinearScale"},"y_range":{"id":"7082","type":"DataRange1d"},"y_scale":{"id":"7086","type":"LinearScale"}},"id":"7077","subtype":"Figure","type":"Plot"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7442","type":"Selection"},"selection_policy":{"id":"7441","type":"UnionRenderers"}},"id":"7402","type":"ColumnDataSource"},{"attributes":{"source":{"id":"7396","type":"ColumnDataSource"}},"id":"7400","type":"CDSView"},{"attributes":{},"id":"7094","type":"BasicTicker"},{"attributes":{},"id":"7433","type":"BasicTickFormatter"},{"attributes":{"dimension":1,"ticker":{"id":"7094","type":"BasicTicker"}},"id":"7097","type":"Grid"},{"attributes":{"text":"scikit-learn"},"id":"7375","type":"Title"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"7098","type":"Toolbar"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"7395","type":"Toolbar"},{"attributes":{"text":"Linear Regression"},"id":"7078","type":"Title"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7397","type":"Circle"},{"attributes":{},"id":"7383","type":"LinearScale"},{"attributes":{"data_source":{"id":"7402","type":"ColumnDataSource"},"glyph":{"id":"7403","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7404","type":"Line"},"selection_glyph":null,"view":{"id":"7406","type":"CDSView"}},"id":"7405","type":"GlyphRenderer"},{"attributes":{},"id":"7440","type":"Selection"},{"attributes":{"callback":null},"id":"7080","type":"DataRange1d"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"7404","type":"Line"},{"attributes":{},"id":"7381","type":"LinearScale"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7398","type":"Circle"},{"attributes":{"callback":null},"id":"7379","type":"DataRange1d"},{"attributes":{},"id":"7086","type":"LinearScale"},{"attributes":{},"id":"7125","type":"BasicTickFormatter"},{"attributes":{"below":[{"id":"7385","type":"LinearAxis"}],"center":[{"id":"7389","type":"Grid"},{"id":"7394","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"7390","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"7399","type":"GlyphRenderer"},{"id":"7405","type":"GlyphRenderer"}],"title":{"id":"7375","type":"Title"},"toolbar":{"id":"7395","type":"Toolbar"},"x_range":{"id":"7377","type":"DataRange1d"},"x_scale":{"id":"7381","type":"LinearScale"},"y_range":{"id":"7379","type":"DataRange1d"},"y_scale":{"id":"7383","type":"LinearScale"}},"id":"7374","subtype":"Figure","type":"Plot"},{"attributes":{"callback":null},"id":"7377","type":"DataRange1d"},{"attributes":{},"id":"7127","type":"BasicTickFormatter"},{"attributes":{},"id":"7386","type":"BasicTicker"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"xAdpxUufuD9qm6YSdXzEP5bjlxTo98Q/8VjzIBV00D/b+tT3k1TVP3gwIqrT3dY/PvmJabPx2j+oYjHyTSTvP4aj8ugel/A//ETZiBlF8T9z5r8oFPPxPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7134","type":"Selection"},"selection_policy":{"id":"7133","type":"UnionRenderers"}},"id":"7109","type":"ColumnDataSource"},{"attributes":{"formatter":{"id":"7433","type":"BasicTickFormatter"},"ticker":{"id":"7386","type":"BasicTicker"}},"id":"7385","type":"LinearAxis"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7105","type":"Circle"},{"attributes":{"callback":null},"id":"7082","type":"DataRange1d"},{"attributes":{},"id":"7131","type":"UnionRenderers"},{"attributes":{},"id":"7431","type":"BasicTickFormatter"},{"attributes":{"source":{"id":"7402","type":"ColumnDataSource"}},"id":"7406","type":"CDSView"},{"attributes":{"ticker":{"id":"7386","type":"BasicTicker"}},"id":"7389","type":"Grid"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7106","type":"Circle"},{"attributes":{},"id":"7442","type":"Selection"},{"attributes":{},"id":"7132","type":"Selection"},{"attributes":{"data_source":{"id":"7104","type":"ColumnDataSource"},"glyph":{"id":"7105","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7106","type":"Circle"},"selection_glyph":null,"view":{"id":"7108","type":"CDSView"}},"id":"7107","type":"GlyphRenderer"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"7403","type":"Line"},{"attributes":{},"id":"7133","type":"UnionRenderers"},{"attributes":{},"id":"7134","type":"Selection"},{"attributes":{"source":{"id":"7104","type":"ColumnDataSource"}},"id":"7108","type":"CDSView"},{"attributes":{"formatter":{"id":"7127","type":"BasicTickFormatter"},"ticker":{"id":"7089","type":"BasicTicker"}},"id":"7088","type":"LinearAxis"},{"attributes":{},"id":"7089","type":"BasicTicker"},{"attributes":{},"id":"7439","type":"UnionRenderers"},{"attributes":{},"id":"7441","type":"UnionRenderers"},{"attributes":{},"id":"7084","type":"LinearScale"},{"attributes":{"line_color":{"value":"green"},"line_dash":[6],"line_width":{"value":3},"location":0.5},"id":"7114","type":"Span"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"7110","type":"Line"},{"attributes":{"dimension":1,"ticker":{"id":"7391","type":"BasicTicker"}},"id":"7394","type":"Grid"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7440","type":"Selection"},"selection_policy":{"id":"7439","type":"UnionRenderers"}},"id":"7396","type":"ColumnDataSource"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"7111","type":"Line"},{"attributes":{"ticker":{"id":"7089","type":"BasicTicker"}},"id":"7092","type":"Grid"},{"attributes":{},"id":"7391","type":"BasicTicker"},{"attributes":{"formatter":{"id":"7431","type":"BasicTickFormatter"},"ticker":{"id":"7391","type":"BasicTicker"}},"id":"7390","type":"LinearAxis"},{"attributes":{"data_source":{"id":"7109","type":"ColumnDataSource"},"glyph":{"id":"7110","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7111","type":"Line"},"selection_glyph":null,"view":{"id":"7113","type":"CDSView"}},"id":"7112","type":"GlyphRenderer"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7132","type":"Selection"},"selection_policy":{"id":"7131","type":"UnionRenderers"}},"id":"7104","type":"ColumnDataSource"}],"root_ids":["7407"]},"title":"Bokeh Application","version":"1.1.0"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('7713').textContent;
                  var render_items = [{"docid":"b979f4b0-8b67-48e0-8416-73c439051e3a","roots":{"7407":"acfcce5e-4a1d-4eeb-8e08-56dac9d7edb6"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        embed_document(root);
                        clearInterval(timer);
                      }
                      attempts++;
                      if (attempts > 100) {
                        console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        clearInterval(timer);
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  </body>
  
</html>

<blockquote>
  <p>Here I use scikit-learn to estimate parameters aim to save some time</p>
</blockquote>

<p>After setting threshold as 0.5 (if output &gt; 0.5, output $\rightarrow$ 1, otherwise 0) and comparing two regressions, we can find <strong>logistic sigmoid</strong> increase the classification accuracy, only one plot was misclassified to 0.</p>

<p>Now we need to consider how to construct the cost function for logistic regression to improve the parameters prediction. The first method we use is the <strong>least squares</strong>.</p>

<h2 id="least-squares-cost-function">Least Squares Cost Function</h2>

<script type="math/tex; mode=display">g(\mathbf{w})=\frac{1}{N} \sum_{i=1}^{N}\left(\sigma\left(\mathbf{w}^{T} \mathbf{x_i}\right)-y_{i}\right)^{2}</script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">sigmoid_least_squares</span><span class="p">(</span><span class="n">w_0</span><span class="p">,</span> <span class="n">w_1</span><span class="p">):</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">cost</span> <span class="o">+=</span> <span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">w_0</span> <span class="o">+</span> <span class="n">w_1</span><span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">cost</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">size</span>

<span class="n">w_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">w0</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">w_0</span><span class="p">,</span> <span class="n">w_1</span><span class="p">)</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">sigmoid_least_squares</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="n">p</span>
<span class="kn">import</span> <span class="nn">mpl_toolkits.mplot3d.axes3d</span> <span class="k">as</span> <span class="n">p3</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">widget</span>
<span class="c1"># %matplotlib inline
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">p3</span><span class="o">.</span><span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span><span class="n">w1</span><span class="p">,</span><span class="n">cost</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'binary'</span><span class="p">)</span>
    <span class="c1"># ax.contourf3D(w0,w1,cost)
</span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'w_0'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'w_1'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">'cost'</span><span class="p">);</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">filename</span><span class="o">=</span><span class="s">'GIF/step'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">'.png'</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="c1">#     p.show()
</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="s">'GIF/LS_gif.gif'</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<iframe src="https://giphy.com/embed/Y3qHdXJC0auQE69C06" width="480" height="360" frameborder="0" class="giphy-embed" allowfullscreen=""></iframe>

<p><img src="/img/in-post/post-MLOptimization-3.jpg" alt="" /></p>

<p>This is not a convex problem, hence we cannot treat this least squares as linear regression. Then we give a derivative to the <em>least squares</em> cost</p>

<script type="math/tex; mode=display">\nabla g({\mathbf{w}})=2 \sum_{i=1}^{N}\left(\sigma\left({\mathbf{w}}^{T} {\mathbf{x_i}}\right)-y_{i}\right) \sigma\left(
{\mathbf{w}}^{T} {\mathbf{x_i}}\right)\left(1-\sigma\left({\mathbf{w}}^{T} {\mathbf{x_i}}\right)\right) {\mathbf{x}}_{i}</script>

<p>Combining the gradient cost function and visualization, this a non-convex problem. And it may cause a problem that some parts of the cost function is too <em>flat</em> that means it will force the gradient or newton stop at some bad parameters.</p>

<p>For this gradient function, it can easily return $0$ when $sigmoid = 1$ with large input value, let me try this Mean Square Error as cost function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">grad</span>
<span class="c1">#         print("gradient = {} | g = {}".format(grad, g))
#     if abs(grad) &lt;= 0.001:
#         break
</span>        
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">g</span>
<span class="c1">#     print("iter = {0} | w = {1} | gradient = {2}".format(iteration, w, grad))
</span>    <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">"iter = {0} | w = {1} | gradient = {2}"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">grad</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>iter = 20000 | w = [-19.99634777  20.00365223] | gradient = 0.0
</pre></td></tr></tbody></table></code></pre></div></div>

<html lang="en">
  
  <head>
    
      <meta charset="utf-8" />
      <title>Bokeh Plot</title>
      
      
        
          
        <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.css" type="text/css" />
        
        
          
        <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.js"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  </head>
  
  
  <body>
    
      
        
          
          
            
              <div class="bk-root" id="d6aa1f4a-3179-4095-9596-ec9609631e2b" data-root-id="7765"></div>
            
          
        
      
      
        <script type="application/json" id="8089">
          {"998591d5-645a-47df-934b-ce9e4f313610":{"roots":{"references":[{"attributes":{"children":[{"id":"7374","subtype":"Figure","type":"Plot"},{"id":"7732","subtype":"Figure","type":"Plot"}]},"id":"7765","type":"Row"},{"attributes":{"data_source":{"id":"7760","type":"ColumnDataSource"},"glyph":{"id":"7761","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7762","type":"Line"},"selection_glyph":null,"view":{"id":"7764","type":"CDSView"}},"id":"7763","type":"GlyphRenderer"},{"attributes":{"data_source":{"id":"7396","type":"ColumnDataSource"},"glyph":{"id":"7397","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7398","type":"Circle"},"selection_glyph":null,"view":{"id":"7400","type":"CDSView"}},"id":"7399","type":"GlyphRenderer"},{"attributes":{"data_source":{"id":"7754","type":"ColumnDataSource"},"glyph":{"id":"7755","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7756","type":"Circle"},"selection_glyph":null,"view":{"id":"7758","type":"CDSView"}},"id":"7757","type":"GlyphRenderer"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7442","type":"Selection"},"selection_policy":{"id":"7441","type":"UnionRenderers"}},"id":"7402","type":"ColumnDataSource"},{"attributes":{"source":{"id":"7396","type":"ColumnDataSource"}},"id":"7400","type":"CDSView"},{"attributes":{"source":{"id":"7760","type":"ColumnDataSource"}},"id":"7764","type":"CDSView"},{"attributes":{},"id":"7433","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"7762","type":"Line"},{"attributes":{"text":"scikit-learn"},"id":"7375","type":"Title"},{"attributes":{"formatter":{"id":"7809","type":"BasicTickFormatter"},"ticker":{"id":"7744","type":"BasicTicker"}},"id":"7743","type":"LinearAxis"},{"attributes":{},"id":"7809","type":"BasicTickFormatter"},{"attributes":{},"id":"7818","type":"Selection"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"7395","type":"Toolbar"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7397","type":"Circle"},{"attributes":{},"id":"7383","type":"LinearScale"},{"attributes":{"data_source":{"id":"7402","type":"ColumnDataSource"},"glyph":{"id":"7403","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"7404","type":"Line"},"selection_glyph":null,"view":{"id":"7406","type":"CDSView"}},"id":"7405","type":"GlyphRenderer"},{"attributes":{},"id":"7440","type":"Selection"},{"attributes":{"callback":null},"id":"7737","type":"DataRange1d"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"7761","type":"Line"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"7404","type":"Line"},{"attributes":{},"id":"7744","type":"BasicTicker"},{"attributes":{},"id":"7381","type":"LinearScale"},{"attributes":{},"id":"7815","type":"UnionRenderers"},{"attributes":{},"id":"7741","type":"LinearScale"},{"attributes":{"callback":null},"id":"7379","type":"DataRange1d"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"7753","type":"Toolbar"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7398","type":"Circle"},{"attributes":{},"id":"7816","type":"Selection"},{"attributes":{"below":[{"id":"7385","type":"LinearAxis"}],"center":[{"id":"7389","type":"Grid"},{"id":"7394","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"7390","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"7399","type":"GlyphRenderer"},{"id":"7405","type":"GlyphRenderer"}],"title":{"id":"7375","type":"Title"},"toolbar":{"id":"7395","type":"Toolbar"},"x_range":{"id":"7377","type":"DataRange1d"},"x_scale":{"id":"7381","type":"LinearScale"},"y_range":{"id":"7379","type":"DataRange1d"},"y_scale":{"id":"7383","type":"LinearScale"}},"id":"7374","subtype":"Figure","type":"Plot"},{"attributes":{"callback":null},"id":"7377","type":"DataRange1d"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"6tkWVJCm6D29oJJBEb10PmDTi0PVqH0+83khmCVuST8/IKMufpzgP3nVb5+bOu0/pL82tSv+7z8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7818","type":"Selection"},"selection_policy":{"id":"7817","type":"UnionRenderers"}},"id":"7760","type":"ColumnDataSource"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7816","type":"Selection"},"selection_policy":{"id":"7815","type":"UnionRenderers"}},"id":"7754","type":"ColumnDataSource"},{"attributes":{},"id":"7386","type":"BasicTicker"},{"attributes":{"formatter":{"id":"7433","type":"BasicTickFormatter"},"ticker":{"id":"7386","type":"BasicTicker"}},"id":"7385","type":"LinearAxis"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7755","type":"Circle"},{"attributes":{},"id":"7442","type":"Selection"},{"attributes":{},"id":"7431","type":"BasicTickFormatter"},{"attributes":{"source":{"id":"7402","type":"ColumnDataSource"}},"id":"7406","type":"CDSView"},{"attributes":{"ticker":{"id":"7386","type":"BasicTicker"}},"id":"7389","type":"Grid"},{"attributes":{"below":[{"id":"7743","type":"LinearAxis"}],"center":[{"id":"7747","type":"Grid"},{"id":"7752","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"7748","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"7757","type":"GlyphRenderer"},{"id":"7763","type":"GlyphRenderer"}],"title":{"id":"7733","type":"Title"},"toolbar":{"id":"7753","type":"Toolbar"},"x_range":{"id":"7735","type":"DataRange1d"},"x_scale":{"id":"7739","type":"LinearScale"},"y_range":{"id":"7737","type":"DataRange1d"},"y_scale":{"id":"7741","type":"LinearScale"}},"id":"7732","subtype":"Figure","type":"Plot"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"7403","type":"Line"},{"attributes":{},"id":"7807","type":"BasicTickFormatter"},{"attributes":{"text":"Mean Squared Error Cost"},"id":"7733","type":"Title"},{"attributes":{"formatter":{"id":"7807","type":"BasicTickFormatter"},"ticker":{"id":"7749","type":"BasicTicker"}},"id":"7748","type":"LinearAxis"},{"attributes":{},"id":"7739","type":"LinearScale"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"7756","type":"Circle"},{"attributes":{"dimension":1,"ticker":{"id":"7749","type":"BasicTicker"}},"id":"7752","type":"Grid"},{"attributes":{"callback":null},"id":"7735","type":"DataRange1d"},{"attributes":{},"id":"7439","type":"UnionRenderers"},{"attributes":{},"id":"7441","type":"UnionRenderers"},{"attributes":{"line_color":{"value":"green"},"line_dash":[6],"line_width":{"value":3},"location":0.5},"id":"7114","type":"Span"},{"attributes":{"ticker":{"id":"7744","type":"BasicTicker"}},"id":"7747","type":"Grid"},{"attributes":{},"id":"7817","type":"UnionRenderers"},{"attributes":{"source":{"id":"7754","type":"ColumnDataSource"}},"id":"7758","type":"CDSView"},{"attributes":{"dimension":1,"ticker":{"id":"7391","type":"BasicTicker"}},"id":"7394","type":"Grid"},{"attributes":{},"id":"7391","type":"BasicTicker"},{"attributes":{"formatter":{"id":"7431","type":"BasicTickFormatter"},"ticker":{"id":"7391","type":"BasicTicker"}},"id":"7390","type":"LinearAxis"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"7440","type":"Selection"},"selection_policy":{"id":"7439","type":"UnionRenderers"}},"id":"7396","type":"ColumnDataSource"},{"attributes":{},"id":"7749","type":"BasicTicker"}],"root_ids":["7765"]},"title":"Bokeh Application","version":"1.1.0"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('8089').textContent;
                  var render_items = [{"docid":"998591d5-645a-47df-934b-ce9e4f313610","roots":{"7765":"d6aa1f4a-3179-4095-9596-ec9609631e2b"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        embed_document(root);
                        clearInterval(timer);
                      }
                      attempts++;
                      if (attempts > 100) {
                        console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        clearInterval(timer);
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  </body>
  
</html>

<p>You can notice that by setting a <em>KNOWN</em> start point will help us get a perfect classification. But what if we have a high-dimension problem? This means we need a better cost function.</p>

<h2 id="cross-entropy-cost-function">Cross Entropy Cost Function</h2>

<p>This method called <strong>Cross Entropy</strong>, but Id like to call <strong>Cross Penalty</strong>.</p>

<script type="math/tex; mode=display">% <![CDATA[
g_{i}(\mathbf{w})=\left\{\begin{array}{ll}{-\log \left(\sigma\left(\mathbf{w}^{T} \mathbf{x_i}\right)\right)} & {\text { if } y_{i}=1} \\ {-\log \left(1-\sigma\left(\mathbf{w}^{T}\mathbf{x_i}\right)\right)} & {\text { if } y_{i}=0}\end{array}\right. %]]></script>

<p>Its a little complex but its crystal clear for visualization.</p>

<html lang="en">
  
  <head>
    
      <meta charset="utf-8" />
      <title>Bokeh Plot</title>
      
      
        
          
        <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.css" type="text/css" />
        
        
          
        <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.js"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  </head>
  
  
  <body>
    
      
        
          
          
            
              <div class="bk-root" id="4d39a168-3c0e-4a89-b499-2828023d63c8" data-root-id="10417"></div>
            
          
        
      
      
        <script type="application/json" id="10794">
          {"dd8f8926-647b-490c-a2da-6a6f6cc917b9":{"roots":{"references":[{"attributes":{"children":[{"id":"10361","subtype":"Figure","type":"Plot"},{"id":"10389","subtype":"Figure","type":"Plot"}]},"id":"10417","type":"Row"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"/Knx0k1iUD8efaCe1LaGP35iccGvsJU/NkPJmfoCoD8u1dlSnS2lPyZn6gtAWKo/Hfn6xOKCrz+KxQW/wlayP4YOjhsU7LQ/glcWeGWBtz9+oJ7Utha6P3npJjEIrLw/dTKvjVlBvz+4vRt1VevAPzbiXyP+NcI/tAak0aaAwz8yK+h/T8vEP7BPLC74FcY/LnRw3KBgxz+smLSKSavIPyq9+Djy9ck/p+E855pAyz8lBoGVQ4vMP6MqxUPs1c0/IU8J8pQgzz/PuSbQnjXQPw7MSCfz2tA/Td5qfkeA0T+M8IzVmyXSP8sCryzwytI/ChXRg0Rw0z9JJ/PamBXUP4g5FTLtutQ/x0s3iUFg1T8GXlnglQXWP0VwezfqqtY/hIKdjj5Q1z/DlL/lkvXXPwKn4Tznmtg/QbkDlDtA2T+AyyXrj+XZP77dR0Lkito//e9pmTgw2z88AozwjNXbP3sUrkfhetw/uibQnjUg3T/5OPL1icXdPzhLFE3eat4/d102pDIQ3z+2b1j7hrXfP/pAPaltLeA/GkrO1BeA4D85U18AwtLgP1lc8CtsJeE/eGWBVxZ44T+YbhKDwMrhP7d3o65qHeI/14A02hRw4j/2icUFv8LiPxaTVjFpFeM/NZznXBNo4z9VpXiIvbrjP3SuCbRnDeQ/lLea3xFg5D+zwCsLvLLkP9LJvDZmBeU/8tJNYhBY5T8R3N6NuqrlPzHlb7lk/eU/UO4A5Q5Q5j9w95EQuaLmP48AIzxj9eY/rwm0Zw1I5z/OEkWTt5rnP+4b1r5h7ec/DSVn6gtA6D8tLvgVtpLoP0w3iUFg5eg/bEAabQo46T+LSauYtIrpP6tSPMRe3ek/ylvN7wgw6j/pZF4bs4LqPwlu70Zd1eo/KHeAcgco6z9IgBGesXrrP2eJoslbzes/h5Iz9QUg7D+mm8QgsHLsP8akVUxaxew/5a3mdwQY7T8Ft3ejrmrtPyTACM9Yve0/RMmZ+gIQ7j9j0iomrWLuP4Pbu1FXte4/ouRMfQEI7z/B7d2oq1rvP+H2btRVre8/AAAAAAAA8D8=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"2Vuhrioq5j+MCKSU9QDmP+tTFt311+U/hWzbhiuv5T80dSSQloblP0OdcPY2XuU/0kGNtgw25T9zGJbMFw7lPxRj9TNY5uQ/CC1k582+5D9fkergeJfkP0UK4BlZcOQ/ksnrim5J5D9wGgUsuSLkP//Lc/Q4/OM/AqXQ2u3V4z+B4AXV16/jP0CzT9j2ieM/Gdo82Upk4z8YMa/L0z7jP1BT3KKRGeM/R0NOUYT04j8EHOTIq8/iP5jK0voHq+I/ANCl15iG4j98C0BPXmLiPweN3FBYPuI/DXAPy4Ya4j8pvsar6fbhP9lZS+CA0+E/IvFBVUyw4T/c96v2S43hP9ep6K9/auE/YRS2a+dH4T9jJzIUgyXhP8XN25JSA+E/CQ2U0FXh4D8aLJ+1jL/gP/ngpSn3neA/X4W2E5V84D8YUkZaZlvgP/KgMuNqOuA/PzXCk6IZ4D8mFU2hGvLfP8hT+vtVsd8/NQmi/vZw3z9Zqzdv/TDfPwwRjxJp8d4/MEtfrDmy3j/3iEX/bnPeP9oGyMwINd4/IAhZ1Qb33T+V2lnYaLndPyzkHZQufN0/ObrtxVc/3T8DQgoq5ALdP3Par3vTxtw/No4ZdSWL3D+tToTP2U/cP7A2MkPwFNw/P9Vth2ja2z+uf41SQqDbPxmr9ll9Zts/pkwhUhkt2z94QJvuFfTaP7y2C+Jyu9o/Dqc23i+D2j8MSQCUTEvaP8+ScLPIE9o/Dby266Pc2T8nxizr3aXZP8YIW192b9k/YcL79Gw52T/nrP5XwQPZP7CVjDNzztg/8fgKMoKZ2D/0nx/97WTYPxtCtD22MNg/Hyj6m9r81z+n0W2/WsnXP0Gc2k42ltc/TWxe8Gxj1z/KVm1J/jDXP1RM1f7p/tY/hsTBtC/N1j8Jar8Oz5vWP4LGv6/HatY/hu4cOhk61j/zLJ1PwwnWP8KtdpHF2dU/1SdToB+q1T98hVMc0XrVP6eLE6XZS9U/Q3+t2Tgd1T+9yL1Y7u7UPzKVZsD5wNQ/T3VTrlqT1D9f+by/EGbUP5RKbJEbOdQ/JMG+v3oM1D8=","dtype":"float64","shape":[100]}},"selected":{"id":"10581","type":"Selection"},"selection_policy":{"id":"10580","type":"UnionRenderers"}},"id":"10384","type":"ColumnDataSource"},{"attributes":{"axis_label":"sigmoid","formatter":{"id":"10578","type":"BasicTickFormatter"},"ticker":{"id":"10401","type":"BasicTicker"}},"id":"10400","type":"LinearAxis"},{"attributes":{"text":"y = 0"},"id":"10390","type":"Title"},{"attributes":{"axis_label":"cost","formatter":{"id":"10572","type":"BasicTickFormatter"},"ticker":{"id":"10378","type":"BasicTicker"},"visible":false},"id":"10377","type":"LinearAxis"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"10410","type":"Toolbar"},{"attributes":{},"id":"10580","type":"UnionRenderers"},{"attributes":{},"id":"10583","type":"Selection"},{"attributes":{"x":{"field":"x"},"y":{"field":"y"}},"id":"10385","type":"Line"},{"attributes":{},"id":"10582","type":"UnionRenderers"},{"attributes":{"callback":null},"id":"10366","type":"DataRange1d"},{"attributes":{"x":{"field":"x"},"y":{"field":"y"}},"id":"10413","type":"Line"},{"attributes":{},"id":"10581","type":"Selection"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"10386","type":"Line"},{"attributes":{"callback":null},"id":"10392","type":"DataRange1d"},{"attributes":{},"id":"10576","type":"BasicTickFormatter"},{"attributes":{"axis_label":"cost","formatter":{"id":"10576","type":"BasicTickFormatter"},"ticker":{"id":"10406","type":"BasicTicker"},"visible":false},"id":"10405","type":"LinearAxis"},{"attributes":{},"id":"10373","type":"BasicTicker"},{"attributes":{},"id":"10401","type":"BasicTicker"},{"attributes":{},"id":"10572","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"10414","type":"Line"},{"attributes":{"below":[{"id":"10400","type":"LinearAxis"}],"center":[{"id":"10404","type":"Grid"},{"id":"10409","type":"Grid"}],"left":[{"id":"10405","type":"LinearAxis"}],"plot_height":200,"plot_width":300,"renderers":[{"id":"10415","type":"GlyphRenderer"}],"title":{"id":"10390","type":"Title"},"toolbar":{"id":"10410","type":"Toolbar"},"x_range":{"id":"10392","type":"DataRange1d"},"x_scale":{"id":"10396","type":"LinearScale"},"y_range":{"id":"10394","type":"DataRange1d"},"y_scale":{"id":"10398","type":"LinearScale"}},"id":"10389","subtype":"Figure","type":"Plot"},{"attributes":{"below":[{"id":"10372","type":"LinearAxis"}],"center":[{"id":"10376","type":"Grid"},{"id":"10381","type":"Grid"}],"left":[{"id":"10377","type":"LinearAxis"}],"plot_height":200,"plot_width":300,"renderers":[{"id":"10387","type":"GlyphRenderer"}],"title":{"id":"10362","type":"Title"},"toolbar":{"id":"10382","type":"Toolbar"},"x_range":{"id":"10364","type":"DataRange1d"},"x_scale":{"id":"10368","type":"LinearScale"},"y_range":{"id":"10366","type":"DataRange1d"},"y_scale":{"id":"10370","type":"LinearScale"}},"id":"10361","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"10396","type":"LinearScale"},{"attributes":{"data_source":{"id":"10412","type":"ColumnDataSource"},"glyph":{"id":"10413","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"10414","type":"Line"},"selection_glyph":null,"view":{"id":"10416","type":"CDSView"}},"id":"10415","type":"GlyphRenderer"},{"attributes":{},"id":"10578","type":"BasicTickFormatter"},{"attributes":{"text":"y = 1"},"id":"10362","type":"Title"},{"attributes":{},"id":"10574","type":"BasicTickFormatter"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"10382","type":"Toolbar"},{"attributes":{},"id":"10406","type":"BasicTicker"},{"attributes":{"ticker":{"id":"10373","type":"BasicTicker"}},"id":"10376","type":"Grid"},{"attributes":{"axis_label":"sigmoid","formatter":{"id":"10574","type":"BasicTickFormatter"},"ticker":{"id":"10373","type":"BasicTicker"}},"id":"10372","type":"LinearAxis"},{"attributes":{"data_source":{"id":"10384","type":"ColumnDataSource"},"glyph":{"id":"10385","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"10386","type":"Line"},"selection_glyph":null,"view":{"id":"10388","type":"CDSView"}},"id":"10387","type":"GlyphRenderer"},{"attributes":{"dimension":1,"ticker":{"id":"10378","type":"BasicTicker"}},"id":"10381","type":"Grid"},{"attributes":{"callback":null},"id":"10394","type":"DataRange1d"},{"attributes":{},"id":"10368","type":"LinearScale"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"/Knx0k1iUD8efaCe1LaGP35iccGvsJU/NkPJmfoCoD8u1dlSnS2lPyZn6gtAWKo/Hfn6xOKCrz+KxQW/wlayP4YOjhsU7LQ/glcWeGWBtz9+oJ7Utha6P3npJjEIrLw/dTKvjVlBvz+4vRt1VevAPzbiXyP+NcI/tAak0aaAwz8yK+h/T8vEP7BPLC74FcY/LnRw3KBgxz+smLSKSavIPyq9+Djy9ck/p+E855pAyz8lBoGVQ4vMP6MqxUPs1c0/IU8J8pQgzz/PuSbQnjXQPw7MSCfz2tA/Td5qfkeA0T+M8IzVmyXSP8sCryzwytI/ChXRg0Rw0z9JJ/PamBXUP4g5FTLtutQ/x0s3iUFg1T8GXlnglQXWP0VwezfqqtY/hIKdjj5Q1z/DlL/lkvXXPwKn4Tznmtg/QbkDlDtA2T+AyyXrj+XZP77dR0Lkito//e9pmTgw2z88AozwjNXbP3sUrkfhetw/uibQnjUg3T/5OPL1icXdPzhLFE3eat4/d102pDIQ3z+2b1j7hrXfP/pAPaltLeA/GkrO1BeA4D85U18AwtLgP1lc8CtsJeE/eGWBVxZ44T+YbhKDwMrhP7d3o65qHeI/14A02hRw4j/2icUFv8LiPxaTVjFpFeM/NZznXBNo4z9VpXiIvbrjP3SuCbRnDeQ/lLea3xFg5D+zwCsLvLLkP9LJvDZmBeU/8tJNYhBY5T8R3N6NuqrlPzHlb7lk/eU/UO4A5Q5Q5j9w95EQuaLmP48AIzxj9eY/rwm0Zw1I5z/OEkWTt5rnP+4b1r5h7ec/DSVn6gtA6D8tLvgVtpLoP0w3iUFg5eg/bEAabQo46T+LSauYtIrpP6tSPMRe3ek/ylvN7wgw6j/pZF4bs4LqPwlu70Zd1eo/KHeAcgco6z9IgBGesXrrP2eJoslbzes/h5Iz9QUg7D+mm8QgsHLsP8akVUxaxew/5a3mdwQY7T8Ft3ejrmrtPyTACM9Yve0/RMmZ+gIQ7j9j0iomrWLuP4Pbu1FXte4/ouRMfQEI7z/B7d2oq1rvP+H2btRVre8/AAAAAAAA8D8=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"rdSK1Vsy5j+Aih7n0FvmP//eIVt7heY/tgB4MFuv5j+FElJlcNnmP7dDL/e6A+c/ZfHc4jou5z8m0XYk8FjnP+QkZ7fag+c/+fdmlvqu5z9wZX67T9rnP3bnBCDaBeg/5K+hvJkx6D/gCUyJjl3oP4zES324ieg/sKY5jxe26D9N6/+0q+LoPyrH2uN0D+k/I/dYEHM86T9EV1wupmnpP5uCGjEOl+k/snsdC6vE6T+RXUSufPLpP0AVxAuDIOo/xyMoFL5O6j9haFO3LX3qPwzzgOTRq+o/NN9Eiqra6j9wNo2WtwnrP0Hbovb4OOs/pXsql25o6z+BiyVkGJjrP5tG80j2x+s/R7pRMAj46z9p1l4ETijsP+aFma7HWOw/TM7iF3WJ7D989n4oVrrsP3q0Fshq6+w/AmK43bIc7T/XN9lPLk7tP9KPVgTdf+0/Oi134L6x7T+xi+zI0+PtPyQ01KEbFu4/+Re5TpZI7j8s8pSyQ3vuPyOu0a8jru4/VtRKKDbh7j9Y/E79ehTvP2hEoQ/yR+8/Kc56P5t77z+DQIxsdq/vP2xO/3WD4+8/SCE8HeEL8D/NxwtMGSbwP3eyPTZqQPA/+aNgytNa8D+o2MP2VXXwPzjXd6nwj/A/aUNP0KOq8D+Ust9Yb8XwP/+BgjBT4PA/9K5VRE/78D92sDyBYxbxP5pS4dOPMfE/O5O0KNRM8T9NgO9rMGjxP04XlImkg/E/KyZubTCf8T9DLRQD1LrxP3hC6DWP1vE/cPUY8WHy8T+gNKIfTA7yP2MzTqxNKvI/w1C2gWZG8j8U/0OKlmLyPyusMbDdfvI/P6qL3Tub8j8uGTH8sLfyP2TQ1PU81PI/90j+s9/w8j8piAogmQ3zPxkKLSNpKvM/tqxwpk9H8z+lmriSTGTzP1U2wdBfgfM/5AQhSYme8z8PmUnkyLvzP9V9iIoe2fM/6SAIJIr28z/hvNCYCxT0P/tCydCiMfQ/ckS4s09P9D9g20QpEm30Pw+T9xjqivQ/pE87ateo9D84NV4E2sb0PxeOks7x5PQ/SbDvrx4D9T8=","dtype":"float64","shape":[100]}},"selected":{"id":"10583","type":"Selection"},"selection_policy":{"id":"10582","type":"UnionRenderers"}},"id":"10412","type":"ColumnDataSource"},{"attributes":{"source":{"id":"10384","type":"ColumnDataSource"}},"id":"10388","type":"CDSView"},{"attributes":{},"id":"10370","type":"LinearScale"},{"attributes":{"dimension":1,"ticker":{"id":"10406","type":"BasicTicker"}},"id":"10409","type":"Grid"},{"attributes":{"callback":null},"id":"10364","type":"DataRange1d"},{"attributes":{"ticker":{"id":"10401","type":"BasicTicker"}},"id":"10404","type":"Grid"},{"attributes":{"source":{"id":"10412","type":"ColumnDataSource"}},"id":"10416","type":"CDSView"},{"attributes":{},"id":"10378","type":"BasicTicker"},{"attributes":{},"id":"10398","type":"LinearScale"}],"root_ids":["10417"]},"title":"Bokeh Application","version":"1.1.0"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('10794').textContent;
                  var render_items = [{"docid":"dd8f8926-647b-490c-a2da-6a6f6cc917b9","roots":{"10417":"4d39a168-3c0e-4a89-b499-2828023d63c8"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        embed_document(root);
                        clearInterval(timer);
                      }
                      attempts++;
                      if (attempts > 100) {
                        console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        clearInterval(timer);
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  </body>
  
</html>

<p>In case $y = 1$, when the sigmoid approaches to 1, cost approches to 0. Conversely, the cost grows to infinity as sigmoid approaches to 0. Thats why I call this is a penalty function. We can summarize two cases into one formula:</p>

<script type="math/tex; mode=display">g_{i}(\mathbf{w}) = -y_i\log(\sigma(\mathbf{w}^{T} \mathbf{x_i})) - (1 - y_i)\log(1 - \sigma(\mathbf{w}^{T} \mathbf{x_i)})</script>

<script type="math/tex; mode=display">\Downarrow</script>

<script type="math/tex; mode=display">g(\mathbf{w}) = -\frac{1}{N}\sum^{N}_{i = 1}y_i\log(\sigma(\mathbf{w}^{T} \mathbf{x_i})) + (1 - y_i)\log(1 - \sigma(\mathbf{w}^{T} \mathbf{x_i)})</script>

<script type="math/tex; mode=display">\Downarrow</script>

<script type="math/tex; mode=display">g(\mathbf{w}) = -\frac{1}{N}\sum^{N}_{i = 1}y_i\mathbf{w}^{T} \mathbf{x_i} - \log(1 + e^{\mathbf{w}^{T} \mathbf{x_i}})</script>

<p>We also get the gradient:</p>

<script type="math/tex; mode=display">\nabla g(\mathbf w) = -\frac{1}{N}\sum^N_{i = 1}(y_i - \sigma(\mathbf w^T\mathbf x_i))\mathbf x_i</script>

<p>And second order gradient:</p>

<script type="math/tex; mode=display">\nabla^2 g(\mathbf w) = \frac{1}{N}\sum^N_{i =1}(\sigma(\mathbf w^T \mathbf x_i))(1-\sigma(\mathbf w^T \mathbf x_i))\mathbf x_i^T\mathbf x_i</script>

<p>If the Hessian Matrix or Second-Order Taylor Approximation is non-negative or positive semi-definite, the original model would be <strong>convex</strong></p>

<p>We can use</p>

<script type="math/tex; mode=display">\mathbf z^T\nabla^2g(w) \mathbf z \geq 0, \ where \ \mathbf  z \ is \ a \ non-zero \ vevtor</script>

<p>to prove this.</p>

<p>Hence, for cross-entropy cost function:</p>

<script type="math/tex; mode=display">\mathbf z^T\nabla^2g(w) \mathbf z = \frac{1}{N}\sum^N_{}(\sigma(\mathbf w^T \mathbf x_i))(1-\sigma(\mathbf w^T \mathbf x_i)) \mathbf z^T\mathbf x_i^T\mathbf x_i \mathbf z \\
\Downarrow \\
\frac{1}{N}\sum^N_{}(\sigma(\mathbf w^T \mathbf x_i))(1-\sigma(\mathbf w^T \mathbf x_i)) (\mathbf x_i \mathbf z)^2 \geq 0</script>

<p>For more details, please read <a href="https://en.wikipedia.org/wiki/Definiteness_of_a_matrix#Negative-definite.2C_semidefinite_and_indefinite_matrices">Definiteness of a matrix</a></p>

<p>Thus logistic regression becomes a pretty straight forward convex-optimization problem, you can choose <em>Gradient Descent</em> or <em>Newtons Method</em> to find the global optimal.</p>

<html lang="en">
  
  <head>
    
      <meta charset="utf-8" />
      <title>Bokeh Plot</title>
      
      
        
          
        <link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.css" type="text/css" />
        
        
          
        <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-1.1.0.min.js"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  </head>
  
  
  <body>
    
      
        
          
          
            
              <div class="bk-root" id="1472ca8f-d927-4c27-99ff-697df9d4303a" data-root-id="9919"></div>
            
          
        
      
      
        <script type="application/json" id="10342">
          {"3a802c11-ee52-4398-8602-cb980b3af793":{"roots":{"references":[{"attributes":{"children":[{"id":"8108","subtype":"Figure","type":"Plot"},{"id":"9885","subtype":"Figure","type":"Plot"}]},"id":"9919","type":"Row"},{"attributes":{},"id":"10071","type":"Selection"},{"attributes":{},"id":"8201","type":"BasicTickFormatter"},{"attributes":{},"id":"8209","type":"UnionRenderers"},{"attributes":{"callback":null},"id":"9888","type":"DataRange1d"},{"attributes":{},"id":"9897","type":"BasicTicker"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"8129","type":"Toolbar"},{"attributes":{},"id":"10060","type":"BasicTickFormatter"},{"attributes":{},"id":"10069","type":"Selection"},{"attributes":{"data_source":{"id":"8130","type":"ColumnDataSource"},"glyph":{"id":"8131","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"8132","type":"Circle"},"selection_glyph":null,"view":{"id":"8134","type":"CDSView"}},"id":"8133","type":"GlyphRenderer"},{"attributes":{"callback":null},"id":"9890","type":"DataRange1d"},{"attributes":{},"id":"8117","type":"LinearScale"},{"attributes":{"formatter":{"id":"8203","type":"BasicTickFormatter"},"ticker":{"id":"8120","type":"BasicTicker"}},"id":"8119","type":"LinearAxis"},{"attributes":{"dimension":1,"ticker":{"id":"8125","type":"BasicTicker"}},"id":"8128","type":"Grid"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"9914","type":"Line"},{"attributes":{"below":[{"id":"9896","type":"LinearAxis"}],"center":[{"id":"9900","type":"Grid"},{"id":"9905","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"9901","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"9910","type":"GlyphRenderer"},{"id":"9916","type":"GlyphRenderer"}],"title":{"id":"9886","type":"Title"},"toolbar":{"id":"9906","type":"Toolbar"},"x_range":{"id":"9888","type":"DataRange1d"},"x_scale":{"id":"9892","type":"LinearScale"},"y_range":{"id":"9890","type":"DataRange1d"},"y_scale":{"id":"9894","type":"LinearScale"}},"id":"9885","subtype":"Figure","type":"Plot"},{"attributes":{"dimension":1,"ticker":{"id":"9902","type":"BasicTicker"}},"id":"9905","type":"Grid"},{"attributes":{},"id":"8125","type":"BasicTicker"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"8210","type":"Selection"},"selection_policy":{"id":"8209","type":"UnionRenderers"}},"id":"8130","type":"ColumnDataSource"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"ZXjtwvcPfjZ6cSuYgD3pOOwT+KYvxA45bqDryGAWlzwo6ljDd+t6P1wc3tgdze8/fv//////7z8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"10071","type":"Selection"},"selection_policy":{"id":"10070","type":"UnionRenderers"}},"id":"9913","type":"ColumnDataSource"},{"attributes":{"source":{"id":"9913","type":"ColumnDataSource"}},"id":"9917","type":"CDSView"},{"attributes":{},"id":"10068","type":"UnionRenderers"},{"attributes":{"callback":null},"id":"8113","type":"DataRange1d"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"8132","type":"Circle"},{"attributes":{"source":{"id":"8136","type":"ColumnDataSource"}},"id":"8140","type":"CDSView"},{"attributes":{"text":"Gradient Descent"},"id":"8109","type":"Title"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"9909","type":"Circle"},{"attributes":{"below":[{"id":"8119","type":"LinearAxis"}],"center":[{"id":"8123","type":"Grid"},{"id":"8128","type":"Grid"},{"id":"7114","type":"Span"}],"left":[{"id":"8124","type":"LinearAxis"}],"plot_height":300,"plot_width":300,"renderers":[{"id":"8133","type":"GlyphRenderer"},{"id":"8139","type":"GlyphRenderer"}],"title":{"id":"8109","type":"Title"},"toolbar":{"id":"8129","type":"Toolbar"},"toolbar_location":null,"x_range":{"id":"8111","type":"DataRange1d"},"x_scale":{"id":"8115","type":"LinearScale"},"y_range":{"id":"8113","type":"DataRange1d"},"y_scale":{"id":"8117","type":"LinearScale"}},"id":"8108","subtype":"Figure","type":"Plot"},{"attributes":{"source":{"id":"8130","type":"ColumnDataSource"}},"id":"8134","type":"CDSView"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"9915","type":"Line"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"8138","type":"Line"},{"attributes":{},"id":"8210","type":"Selection"},{"attributes":{"callback":null},"id":"8111","type":"DataRange1d"},{"attributes":{"data_source":{"id":"9913","type":"ColumnDataSource"},"glyph":{"id":"9914","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"9915","type":"Line"},"selection_glyph":null,"view":{"id":"9917","type":"CDSView"}},"id":"9916","type":"GlyphRenderer"},{"attributes":{"data_source":{"id":"8136","type":"ColumnDataSource"},"glyph":{"id":"8137","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"8138","type":"Line"},"selection_glyph":null,"view":{"id":"8140","type":"CDSView"}},"id":"8139","type":"GlyphRenderer"},{"attributes":{"ticker":{"id":"8120","type":"BasicTicker"}},"id":"8123","type":"Grid"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"9908","type":"Circle"},{"attributes":{"formatter":{"id":"10062","type":"BasicTickFormatter"},"ticker":{"id":"9897","type":"BasicTicker"}},"id":"9896","type":"LinearAxis"},{"attributes":{},"id":"8211","type":"UnionRenderers"},{"attributes":{"formatter":{"id":"8201","type":"BasicTickFormatter"},"ticker":{"id":"8125","type":"BasicTicker"}},"id":"8124","type":"LinearAxis"},{"attributes":{},"id":"8120","type":"BasicTicker"},{"attributes":{},"id":"10070","type":"UnionRenderers"},{"attributes":{},"id":"10062","type":"BasicTickFormatter"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"10069","type":"Selection"},"selection_policy":{"id":"10068","type":"UnionRenderers"}},"id":"9907","type":"ColumnDataSource"},{"attributes":{"ticker":{"id":"9897","type":"BasicTicker"}},"id":"9900","type":"Grid"},{"attributes":{},"id":"8115","type":"LinearScale"},{"attributes":{"source":{"id":"9907","type":"ColumnDataSource"}},"id":"9911","type":"CDSView"},{"attributes":{"data_source":{"id":"9907","type":"ColumnDataSource"},"glyph":{"id":"9908","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"9909","type":"Circle"},"selection_glyph":null,"view":{"id":"9911","type":"CDSView"}},"id":"9910","type":"GlyphRenderer"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"8131","type":"Circle"},{"attributes":{},"id":"8212","type":"Selection"},{"attributes":{"line_color":{"value":"green"},"line_dash":[6],"line_width":{"value":3},"location":0.5},"id":"7114","type":"Span"},{"attributes":{},"id":"8203","type":"BasicTickFormatter"},{"attributes":{"text":"Newton's Method"},"id":"9886","type":"Title"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","logo":null},"id":"9906","type":"Toolbar"},{"attributes":{},"id":"9902","type":"BasicTicker"},{"attributes":{"line_color":"red","x":{"field":"x"},"y":{"field":"y"}},"id":"8137","type":"Line"},{"attributes":{},"id":"9892","type":"LinearScale"},{"attributes":{},"id":"9894","type":"LinearScale"},{"attributes":{"formatter":{"id":"10060","type":"BasicTickFormatter"},"ticker":{"id":"9902","type":"BasicTicker"}},"id":"9901","type":"LinearAxis"},{"attributes":{"callback":null,"data":{"x":{"__ndarray__":"gRHJLCGSwL+QnXMjGuzFP4gIMYJgMcg/ZHRAoAca5D/gO0scX5XvP5qZmZmZmfE/ZmZmZmZm9j8AAAAAAAAQQDMzMzMzMxFAAAAAAAAAEkDNzMzMzMwSQA==","dtype":"float64","shape":[11]},"y":{"__ndarray__":"vmjhjFjePTy0AlPry7swPcN7hWdhGz89chrc3/kyoT69fL6E2wrAP2KDp3ayNew/LSvJIPj/7z8AAAAAAADwPwAAAAAAAPA/AAAAAAAA8D8AAAAAAADwPw==","dtype":"float64","shape":[11]}},"selected":{"id":"8212","type":"Selection"},"selection_policy":{"id":"8211","type":"UnionRenderers"}},"id":"8136","type":"ColumnDataSource"}],"root_ids":["9919"]},"title":"Bokeh Application","version":"1.1.0"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('10342').textContent;
                  var render_items = [{"docid":"3a802c11-ee52-4398-8602-cb980b3af793","roots":{"9919":"1472ca8f-d927-4c27-99ff-697df9d4303a"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        embed_document(root);
                        clearInterval(timer);
                      }
                      attempts++;
                      if (attempts > 100) {
                        console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        clearInterval(timer);
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  </body>
  
</html>

<p>I set all iteration == 5000, we can see for this small scale problem, <strong>Newtons Method</strong> is also the best. From now, we can build our own logistic regresion for binary classification. Next blog I will give a quick review to softmax  logistic regression multi-classification.</p>

<hr />

<p>Code: <a href="https://github.com/linchrisdeng/ML_post/tree/master/ML_02_Logistic_Regression">GItHub</a> &amp; <a href="https://nbviewer.jupyter.org/github/linchrisdeng/ML_post/blob/master/ML_02_Logistic_Regression/ML_02_logit.ipynb">nbviewer</a></p>


                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2019/03/26/Linear-Regression-Parameter-Estimation/" data-toggle="tooltip" data-placement="top" title="Linear Regression -- Parameter Estimation">
                                Previous<br>
                                <span>Linear Regression -- Parameter Estimation</span>
                            </a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2019/03/29/Logistic-Regression-tanh-Cost-Function/" data-toggle="tooltip" data-placement="top" title="Logistic Regression -- Hyperbolic Tangent (tanh) Cost Function">
                                Next<br>
                                <span>Logistic Regression -- Hyperbolic Tangent (tanh) Cost Function</span>
                            </a>
                        </li>
                    
                </ul>
                <hr style="visibility: hidden;">
                
                
            </div>
            <!-- Side Catalog Container -->
            
                <div class="
                    col-lg-2 col-lg-offset-0
                    visible-lg-block
                    sidebar-container
                    catalog-container">
                    <div class="side-catalog">
                        <hr class="hidden-sm hidden-xs">
                        <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                        </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        
        <!-- Sidebar Container -->
        <div class="
            col-lg-8 col-lg-offset-2
            col-md-10 col-md-offset-1
            sidebar-container">
            <!-- Featured Tags -->
            


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        </a>
        
        
                <a data-sort="0001" 
                    href="/archive/?tag=Optimization"
                    title="Optimization"
                    rel="8">Optimization</a>
        
                <a data-sort="0003" 
                    href="/archive/?tag=Machine+Learning"
                    title="Machine Learning"
                    rel="6">Machine Learning</a>
        
                <a data-sort="0003" 
                    href="/archive/?tag=Python"
                    title="Python"
                    rel="6">Python</a>
        
                <a data-sort="0006" 
                    href="/archive/?tag=Gradient+Descent"
                    title="Gradient Descent"
                    rel="3">Gradient Descent</a>
        
                <a data-sort="0007" 
                    href="/archive/?tag=Binary"
                    title="Binary"
                    rel="2">Binary</a>
        
                <a data-sort="0007" 
                    href="/archive/?tag=Classification"
                    title="Classification"
                    rel="2">Classification</a>
        
                <a data-sort="0007" 
                    href="/archive/?tag=Convex"
                    title="Convex"
                    rel="2">Convex</a>
        
                <a data-sort="0007" 
                    href="/archive/?tag=Logistic+Regression"
                    title="Logistic Regression"
                    rel="2">Logistic Regression</a>
        
                <a data-sort="0007" 
                    href="/archive/?tag=Newton%27s+Method"
                    title="Newton's Method"
                    rel="2">Newton's Method</a>
        
                <a data-sort="0007" 
                    href="/archive/?tag=Perceptron"
                    title="Perceptron"
                    rel="2">Perceptron
    </div>
</section>

            <!-- Friends Blog -->
            <!-- 
<hr>
<h5>LINKS</h5>
<ul class="list-inline">
  
  <li><a href="http://huangxuan.me">Hux Blog</a></li>
  
  <li><a href="#">Foo</a></li>
  
  <li><a href="#">Bar</a></li>
  
  <li><a href="#">Example Friends</a></li>
  
  <li><a href="#">It helps SEO</a></li>
  
</ul>
 -->
        </div>
    </div>
</div>
</article>


<!-- Stuff for jsarr tag  -->

<!-- End Stuff for jsarr tag  -->


<!-- add support for mathjax by voleking-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    SVG: {
      scale: 90
    },
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>




<!-- async load function -->
<script>
function async(u, c) {
var d = document, t = 'script',
o = d.createElement(t),
s = d.getElementsByTagName(t)[0];
o.src = u;
if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
s.parentNode.insertBefore(o, s);
}
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
anchors.options = {
visible: 'always',
placement: 'right',
icon: ''
};
anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
})
</script>
<style>
/* place left on bigger screen */
@media all and (min-width: 800px) {
.anchorjs-link{
position: absolute;
left: -0.75em;
font-size: 1.1em;
margin-top : -0.1em;
}
}
</style>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/linchrisdeng">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.linkedin.com/in/lin-deng-280200137">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Lin Blog 2019
                    <br>
                    Powered by <a href="https://jekyllrb.com/">Jekyll</a> & 
                    Theme by <a href="https://tianqi.name/jekyll-TeXt-theme/docs/en/structure">TeXt </a> &
                        <a href="https://github.com/Huxpro/huxpro.github.io#boilerplate-beta">Hux</a> 

<!--                     |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true" >
                    </iframe> -->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->





<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-139933717-1';
    var _gaDomain = 'linchrisdeng.github.io';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->




<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
